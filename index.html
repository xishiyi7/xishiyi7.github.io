<!doctype html>
<html class="theme-next   use-motion ">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />












  <link href="/vendors/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css"/>




  <link href="//fonts.googleapis.com/css?family=Lato:300,400,700,400italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">



<link href="/vendors/font-awesome/css/font-awesome.min.css?v=4.4.0" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=0.4.5.2" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, NexT" />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=0.4.5.2" />






<meta name="description" content="this is my personal post">
<meta property="og:type" content="website">
<meta property="og:title" content="阿根廷人。">
<meta property="og:url" content="https://github.com/xishiyi7/xishiyi7.github.io/index.html">
<meta property="og:site_name" content="阿根廷人。">
<meta property="og:description" content="this is my personal post">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="阿根廷人。">
<meta name="twitter:description" content="this is my personal post">



<script type="text/javascript" id="hexo.configuration">
  var CONFIG = {
    scheme: '',
    sidebar: 'hide',
    motion: true
  };
</script>

  <title> 阿根廷人。 </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  <!--[if lte IE 8]>
  <div style=' clear: both; height: 59px; padding:0 0 0 15px; position: relative;margin:0 auto;'>
    <a href="http://windows.microsoft.com/en-US/internet-explorer/products/ie/home?ocid=ie6_countdown_bannercode">
      <img src="http://7u2nvr.com1.z0.glb.clouddn.com/picouterie.jpg" border="0" height="42" width="820"
           alt="You are using an outdated browser. For a faster, safer browsing experience, upgrade for free today or use other browser ,like chrome firefox safari."
           style='margin-left:auto;margin-right:auto;display: block;'/>
    </a>
  </div>
<![endif]-->
  



  <script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "//hm.baidu.com/hm.js?ba79b70fc8075ea38398e9197ab4fc9e";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>




  <div class="container one-column 
   page-home 
">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/"  class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">阿根廷人。</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
  <p class="site-subtitle">xishiyi7</p>
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu ">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-home fa-fw"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-archive fa-fw"></i> <br />
            
            归档
          </a>
        </li>
      

      
      
    </ul>
  

  
</nav>

 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div id="content" class="content">
          
  <section id="posts" class="posts-expand">

    

    
    

    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/08/18/各领风骚の前端网站/" itemprop="url">
                  各领风骚之前端网站
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            发表于
            <time itemprop="dateCreated" datetime="2016-08-18T16:23:35+08:00" content="2016-08-18">
              2016-08-18
            </time>
          </span>

          

          
            
              <span class="post-comments-count" style="display:none">
                &nbsp; | &nbsp;
                <a href="/2016/08/18/各领风骚の前端网站/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/08/18/各领风骚の前端网站/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

        </div>
      </header>
    


    <div class="post-body">

      
      

      
        
          <span itemprop="articleBody">
            
              <p>本文主要介绍一些对自己技术有很大帮助的网站，后续也将更新，感谢这些网站的相关人员，致敬!</p>
<h3 id="Can_I_Use"><a href="http://caniuse.com/" target="_blank" rel="external">Can I Use</a></h3><p><code>can i use</code>网站很常见，很多博客里面介绍一些CSS/JS/H5新特性的时候，会用到它，可以用来查看某一特性在各浏览器的支持程度，使用效果如下图：<br><code class="normal-img"><img src="../../../../images/20160818/1.png" alt="function"></code></p>
<h3 id="学习CSS布局"><a href="http://zh.learnlayout.com/" target="_blank" rel="external">学习CSS布局</a></h3><p>该网站虽然功能比较单一，只介绍CSS布局相关的知识，但是界面和介绍比较通俗易懂，适合CSS初学者学习，如下图：<br><code class="normal-img"><img src="../../../../images/20160818/2.png" alt="function"></code></p>
<h3 id="Understanding_JavaScript_OOP"><span style="color:coral;"><a href="http://robotlolita.me/2011/10/09/understanding-javascript-oop.html" target="_blank" rel="external">Understanding JavaScript OOP</a></span></h3><p>本文是一篇2011年的国外文章，主要介绍<code>JavaScript OOP</code>。推荐这篇文章的原因并不是写的有多好，而是个人觉得此文比较适合作为慢慢阅读英文博客的开始，另外该站还有一些其他技术博客可供赏阅。<br><code class="normal-img"><img src="../../../../images/20160818/3.png" alt="function"></code></p>
<h3 id="奇舞周刊"><a href="http://old.75team.com/weekly" target="_blank" rel="external">奇舞周刊</a></h3><p>本站每周会更新一次，更新的内容都是一些比较有质量的前端知识。<br><code class="normal-img"><img src="../../../../images/20160818/4.png" alt="function"></code></p>
<h3 id="free-programming-books"><a href="https://github.com/vhf/free-programming-books/blob/master/free-programming-books.md">free-programming-books</a></h3><p>该资源提供广大网友贡献的一些编程书籍列表，涉及领域很多，每个领域也有细分多个分支，如果有需要可以上去看看，不过大多是英文版。</p>
<h3 id="JavaScript_标准库"><a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects" target="_blank" rel="external">JavaScript 标准库</a></h3><p>该资源由<code>MOZILIA MDN</code>提供，算是一份比较详尽的JavaScript参考文档，唯一的缺点是由网友贡献，并不算完善。<br><code class="normal-img"><img src="../../../../images/20160818/5.png" alt="function"></code></p>
<h3 id="FontAwesome"><a href="http://fontawesome.io/icons" target="_blank" rel="external">FontAwesome</a></h3><p>提供字体图标，我介绍这个并不只是简单的引用后当图标来用—-你可以将字体文件下载下来，然后用PS，按照自己需求，做成透明雪碧图，可换颜色。<br><code class="normal-img"><img src="../../../../images/20160818/8.png" alt="function"></code></p>
<hr>
<hr>
<p><img src="../../../../images/money.png" alt="money">☜☜☜ <strong><em>wechat</em></strong> 『『『<strong><em> reward 点击扫码打赏 ~~~ ^_^ </em></strong>  』』』<strong><em>alipay</em></strong> ☞☞☞   <img src="../../../../images/money.jpg" alt="money"></p>
<hr>
<hr>

            
          </span>
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/08/12/我理解的javascript对象创建、原型、继承/" itemprop="url">
                  我理解的javascript对象创建、原型、继承
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            发表于
            <time itemprop="dateCreated" datetime="2016-08-12T12:01:29+08:00" content="2016-08-12">
              2016-08-12
            </time>
          </span>

          

          
            
              <span class="post-comments-count" style="display:none">
                &nbsp; | &nbsp;
                <a href="/2016/08/12/我理解的javascript对象创建、原型、继承/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/08/12/我理解的javascript对象创建、原型、继承/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

        </div>
      </header>
    


    <div class="post-body">

      
      

      
        
          <span itemprop="articleBody">
            
              <p>对js对象创建、原型、原形链、继承及”类”的理解，由于其间各种复杂的关系及掌握程度不够，个人经常需要翻资料确认，于是找时间整理了下当时的理解，并以此文形式记录下来。</p>
<h3 id="面向对象">面向对象</h3><p>oop，面向对象编程。主要有以下几大特征:</p>
<ul>
<li>类，具有相同结构和行为的集合。</li>
<li>封装，将操作封闭，对外提供接口供使用。</li>
<li>继承，子类具有基类(父类)的特征，还可以有自己的新的特性。</li>
<li>多态，一个功能可以有多种不同用法，或者说一个子类可以将父类某个属性替换，具体的包括重写(override, 方法名称与参数相同)和重载(overload, 方法名称相同，参数不同)。</li>
</ul>
<h3 id="JavaScript对象">JavaScript对象</h3><p>js对象，除“null”外，其他的可以看做是属性的无序集合，每个属性都是一个名/值对，<span style="color:coral;">且其拥有一个连接到原型对象的隐藏连接。</span>“null”可以理解成不是对象的对象。函数，也是对象。js对象是动态的，可以新增和删除属性，通过引用而非值来操作对象。每个属性还有与之相关的一些其他值，称为“属性特性(property attribute)”:</p>
<ul>
<li>可写(writable attribute)，表明是否可以设置该属性的值；</li>
<li>可枚举(enumerable attribute)，表明是否可以通过for/in循环返回该属性；</li>
<li>可配置(configurable attribute)，表明是否可以删除或修改该属性。</li>
</ul>
<p>这三个特性是在ES5之后可以加以配置，在ES5之前，通过代码给对象创建的属性都是可写的、可枚举的和可配置的。除了包含属性之外，每个对象还拥有三个相关的对象特性(object attribute):</p>
<ul>
<li>对象的原型(prototype)指向另外一个对象，本对象的属性继承自它的原型对象；</li>
<li>对象的类(class)是一个标识对象类型的字符串；</li>
<li>对象的扩展标记(extensible flag)指明了是否可以向该对象添加新属性。</li>
</ul>
<p>js对象的属性包括两类：自有属性(own property)及继承属性(inherited property)。</p>
<h3 id="原型">原型</h3><p>原型是对象的内部属性，可以将其理解为指向<code>构造函数原型对象</code>的内部指针，默认不可访问，部分浏览器实现可以通过<code>.__proto__</code>访问(eg.Chrome)，我们可以结合<code>.__proto__</code>来加深理解。<br>先说我知道的几个没有原型的对象：</p>
<ul>
<li><code>null</code>没有原型；</li>
<li><code>Object.prototype</code>没有原型(或者说原型为<code>null</code>)。</li>
</ul>
<p>然后介绍几种获取对象的原型属性的方法：</p>
<ul>
<li>所有通过对象直接量创建的对象都具有同一个原型对象—<code>Object.prototype</code>；</li>
<li>通过关键字new和构造函数调用创建的对象，<span style="color:coral;">它的原型就是构造函数的prototype属性的值</span>。即，通过new Date()创建的对象，其原型就是Date.prototype；</li>
<li>通过Object.create()创建的对象使用第一个参数(可以是null)作为它们的原型；</li>
</ul>
<p>每个<span style="color:coral;">函数对象</span>在创建时会带有一个<code>prototype</code>属性，它的值是一个拥有<code>constructor</code>属性且值即为该函数本身的对象。<br>当一个函数对象被创建时，Function构造器产生的函数对象会运行类似下面的代码：<br><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">this</span>.prototype = &#123;<span class="string">constructor:</span><span class="keyword">this</span>, <span class="string">__proto__:</span>...&#125;;</span><br></pre></td></tr></table></figure></p>
<p><span style="color:coral;">新函数对象被赋予一个<code>prototype</code>属性，其值包含一个<code>constructor</code>属性且属性值为该新函数对象本身。</span></p>
<pre>
    var C = function(){
        this.key = 'key';
    };
    C.prototype.constructor === C;    // <span style="color:limegreen;">true</span>
</pre>

<p><code class="normal-img"><img src="../../../../images/20160812/1.png" alt="function"></code></p>
<p>上面的概念说完了，可以利用chrome的console面板，通过以下代码加深理解：</p>
<pre>
    null.__proto__    // <span style="color:limegreen;">Uncaught TypeError: Cannot read property '__proto__' of null</span>
    Object.prototype.__proto__    // <span style="color:limegreen;">null</span>
    var o = {};
    o.__proto__ === Object.prototype    // <span style="color:limegreen;">true</span>
    var A = function(){};
    A.__proto__ === Function.prototype    // <span style="color:limegreen;">true</span>
    A.prototype.constructor === A    // <span style="color:limegreen;">true</span>
    A.prototype.__proto__ === Object.prototype    // <span style="color:limegreen;">true</span>
    var a = new A();
    a.__proto__ === A.prototype    // <span style="color:limegreen;">true</span>
    var b = Object.create(A);
    var c = Object.create(A.prototype);
    var empty = Object.create(null);
    b.__proto__ === A    // <span style="color:limegreen;">true 注意此处，对象b的原型为A</span>
    c.__proto__ === A.prototype    // <span style="color:limegreen;">true 注意此处，对象c的原型为A.prototype</span>
    empty.__proto__    // <span style="color:limegreen;">undefined 注意跟上面对象o的区别</span>
</pre>

<p><code class="normal-img"><img src="../../../../images/20160812/2.png" alt="__proto__"></code></p>
<h3 id="原形链">原形链</h3><p>如上面所述，几乎每个对象都有<code>原型(__proto__)</code>。如果其原型不为null，且是以构造函数形式创建的对象，其原型指向该<code>构造函数的prototype属性</code>。该<code>构造函数的prototype属性</code>也有<code>原型(__proto__)</code>，如果不为null，则接着往上引用，直到原型为null。如下代码所示：</p>
<pre>
    var A = function(){};
    var a = new A();
    a.__proto__ === A.prototype;    // <span style="color:limegreen;">true</span>
    A.prototype.__proto__ === Object.prototype;    // <span style="color:limegreen;">true</span>
    Object.prototype.__proto__ === null;    // <span style="color:limegreen;">true</span>
</pre>
像上面这样通过`原型(__proto__)`一直往上可以串联起来就是原型链。

<h3 id="创建对象">创建对象</h3>
可以通过对象字面量、new及(ES5)Object.create()方法来创建对象。
+ 对象字面量创建方式很简单，`var a = {}`；
+ 通过关键字`new`创建，也可以叫做通过`构造函数`创建，比如：`var date = new Date()`；
+ 通过ES5新提供的方法，`Object.create()`创建。其接收两个参数，第一个参数是当前要创建对象的原型，第二个参数表示当前要创建对象的特性约束，即是否可写、可配置等。下面代码简单介绍下使用及细节：
<pre>
    var a = Object.create(null);
    a.__proto__        // <span style="color:limegreen;">undefined 此时a是一个连原型都没有的空对象</span>
    var b = Object.create({});
    b.__proto__        // <span style="color:limegreen;">Object {}, b是一个普通的空对象，其有原型，指向空的Object`{}`</span>
    var c = Object.create(Object.prototype);
    c.__proto__ === Object.prototype    // <span style="color:limegreen;">true</span>
</pre>

<p>上面介绍的是创建对象的最基础方法，这里稍微扩展一些，介绍几种关于创建对象的设计模式：</p>
<ul>
<li>工厂模式，此模式抽象了创建具体对象的过程，用函数来封装以特定接口创建对象的细节，如下所示：<pre>
  function create(name,age){
      var o = new Object();
      o.name = name;
      o.age = age;
      return o;
  }
  var p1 = create('li',20);
  var p2 = create('wu',30);
</pre></li>
<li>构造函数模式，上面已经涉及，平常也经常用到，不举例子了；</li>
<li>原型模式，此方式将属性写在构造函数的<code>prototype</code>上面，实用性不强，一般不用；</li>
<li>原型模式与构造函数组合使用，此模式将共享的属性和方法写在<code>prototype</code>上，构造函数里面用于自定义属性，比较通用。</li>
<li>…</li>
</ul>
<h3 id="继承">继承</h3><p>js实现继承的方式很多，下面我介绍的只是用的比较多的一种，可以叫做：组合继承。其将原形链和借用构造函数技术组合到一块，发挥各自的长处实现的一种继承模式。<br>其背后的思路是使用原形链实现对原型属性和方法的继承，而通过借用构造函数来实现对实例属性的继承，如下面例子：</p>
<pre>
    function Man(name){
        this.name = name;
        this.sex = 'male';
    }
    Man.prototype.myName = function(){
        console.log(this.name);
    };

    function Son(name,age){
        // 继承属性
        Man.call(this,name);
        this.age = age;
    }
    Son.prototype = Object.create(Man.prototype);
    Son.prototype.myAge = function(){
        console.log(this.age);
    }
    Son.prototype.constructor = Son;    // <span style="color:coral;">由于上面更改了Son.prototype的值，将其中的constructor值也改变了，因此此处必须将其写回</span>
    var li = new Son('li',20);
    li.myName();    // li
    li.myAge();        // 20
    li.sex;        // male
</pre>

<h3 id="最后">最后</h3><p>继承、创建对象，还有其他的一些形式，目前我不大常用，所以没有在上文提及，有兴趣的可以自行了解。</p>
<h3 id="参考资料">参考资料</h3><p>《JavaScript语言精粹》<br>《JavaScript权威指南(第6版)》<br>《JavaScript高级程序设计(第2版)》等</p>
<hr>
<hr>
<p><img src="../../../../images/money.png" alt="money">☜☜☜ <strong><em>wechat</em></strong> 『『『<strong><em> reward 点击扫码打赏 ~~~ ^_^ </em></strong>  』』』<strong><em>alipay</em></strong> ☞☞☞   <img src="../../../../images/money.jpg" alt="money"></p>
<hr>
<hr>

            
          </span>
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/08/11/CSS一些偏僻用法-持续更新/" itemprop="url">
                  CSS一些偏僻用法(持续更新)
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            发表于
            <time itemprop="dateCreated" datetime="2016-08-11T11:39:36+08:00" content="2016-08-11">
              2016-08-11
            </time>
          </span>

          

          
            
              <span class="post-comments-count" style="display:none">
                &nbsp; | &nbsp;
                <a href="/2016/08/11/CSS一些偏僻用法-持续更新/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/08/11/CSS一些偏僻用法-持续更新/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

        </div>
      </header>
    


    <div class="post-body">

      
      

      
        
          <span itemprop="articleBody">
            
              <p>之前经常会看到一些日常比较少见的CSS用法，事后想起要用的时候找半天，特意留一文记录，有待日后持续更新。</p>
<ul>
<li><p>font-variant: small-caps</p>
<pre>
  desc:    指定文本为小型大写字母;
  tips:    使用此样式，大写字母显示保持不变，小写字母为小一号的大写字母了。
  usage:    <span style="font-variant:small-caps">this IS demo</span>
</pre>
</li>
<li><p>-webkit-filter: drop-shadow(rgb(102, 153, 153) 20px 0px);</p>
<pre>
  desc:    可以利用CSS3滤镜实现给图片换颜色;
  tips:    目前需要比较新版本浏览器支持;
  usage:    可参考文章:<a href="http://www.zhangxinxu.com/wordpress/?p=5429" target="_blank" rel="external">张鑫旭blog:PNG格式小图标的CSS任意颜色赋色技术</a>
</pre>
</li>
<li><p>color</p>
<pre>
  这里主要是一点提示，CSS颜色可以用名称、16进制数字或者rgb等多种方式表示，如果用一些比较少见的名称表示的话，你要留意是否其他浏览器支持。
  有一点我之前没有注意到的是，纯绿色，并不是：<span style="background-color:green;">`green`--#008000--</span>，    而是：<span style="background-color:lime;">`lime`--#00ff00--</span>
</pre>




</li>
</ul>
<hr>
<hr>
<p><img src="../../../../images/money.png" alt="money">☜☜☜ <strong><em>wechat</em></strong> 『『『<strong><em> reward 点击扫码打赏 ~~~ ^_^ </em></strong>  』』』<strong><em>alipay</em></strong> ☞☞☞   <img src="../../../../images/money.jpg" alt="money"></p>
<hr>
<hr>

            
          </span>
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/07/10/gulp搭配命令行参数实现前端自动化构建的多样化/" itemprop="url">
                  gulp搭配命令行参数实现前端自动化构建的多样化
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            发表于
            <time itemprop="dateCreated" datetime="2016-07-10T20:47:12+08:00" content="2016-07-10">
              2016-07-10
            </time>
          </span>

          

          
            
              <span class="post-comments-count" style="display:none">
                &nbsp; | &nbsp;
                <a href="/2016/07/10/gulp搭配命令行参数实现前端自动化构建的多样化/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/07/10/gulp搭配命令行参数实现前端自动化构建的多样化/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

        </div>
      </header>
    


    <div class="post-body">

      
      

      
        
          <span itemprop="articleBody">
            
              <p>上面一篇文章简单介绍了gulp的相关知识及在项目中如何使用gulp进行自动化构建，本文简单介绍下如何搭配gulp做一些其他的逻辑处理，只是提供一种思路，不表示可以完全套用。</p>
<h3 id="如果没有合适的插件怎么办？">如果没有合适的插件怎么办？</h3><p>通过npm安装的gulp插件，都是先想想自己要的需求，然后上npm社区找，万一找不到或者自己不会找，怎么办？</p>
<ul>
<li>假设一个需求<br>我们先假设一个简单的需求：每次发布指令生成的文件带上当前时间信息。</li>
<li>处理思路<br>拿到这个需求第一反应可能还是先上社区找一下，没找到，怎么办？试着变通一下，如果没找到，那我自己写一个插件岂不是也可以。<br>想法很好，也可以行得通，目前有<code>through2</code>插件可以帮助我们写gulp插件，但是写一个插件对一个gulp初学者来说可能还是比较难的事情，那么我们换一个思路。<br>我们可以尝试在每次<code>gulp.dest</code>前，先给最终要生成的文件重命名，添加时间戳，这样可以保证正常情况下每次构建后的文件跟之前文件名都不一样。</li>
<li>实现<br>简单的根据时间戳重命名，单个文件还好，多个文件的话，由于很多异步操作，记录时间的时刻必须比较特别，选用执行命令的那一刻可能更好些。</li>
</ul>
<p>有些时候，开发版指令可能需求简单些，或者单个task的需求简单些，这时可以用命令行参数搭配使用来方便构建。</p>
<h3 id="搭配命令行参数">搭配命令行参数</h3><p>命令行参数可以用<code>process.argv</code>获取，拿到的第三个参数，可以表示为当前task的参数。<br>因此，我们可以拿这个来做简单的区分，如果是特殊命令，可以选择携带一个特殊的参数，这样不用每次都单独写任务来表示。</p>
<h3 id="使用多彩的控制台输出">使用多彩的控制台输出</h3><p>npm社区有不少模块可以帮助生成多彩的控制台输出，虽然这对项目构建没有实际的作用，但是可以很清楚的区分当前使用的任务。</p>
<h3 id="替换多个输出的文件名">替换多个输出的文件名</h3><p>如果有需求是替换某个文件夹中的所有文件名，此需求与上面的需求类似，可以一起进行。<br>具体代码可以自己琢磨，可以使用<code>path</code>模块的path.join方法来实现。</p>
<h3 id="最后">最后</h3><p>由于自己对这方面也不是很熟悉，只是根据自己的经验提供一个解决问题的思路，希望可以举一反三，而不是滥用。</p>
<hr>
<hr>
<p><img src="../../../../images/money.png" alt="money">☜☜☜ <strong><em>wechat</em></strong> 『『『<strong><em> reward 点击扫码打赏 ~~~ ^_^ </em></strong>  』』』<strong><em>alipay</em></strong> ☞☞☞   <img src="../../../../images/money.jpg" alt="money"></p>
<hr>
<hr>

            
          </span>
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/07/10/angular项目中比较好用的gulp构建插件/" itemprop="url">
                  angular项目中比较好用的gulp构建插件
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            发表于
            <time itemprop="dateCreated" datetime="2016-07-10T20:40:02+08:00" content="2016-07-10">
              2016-07-10
            </time>
          </span>

          

          
            
              <span class="post-comments-count" style="display:none">
                &nbsp; | &nbsp;
                <a href="/2016/07/10/angular项目中比较好用的gulp构建插件/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/07/10/angular项目中比较好用的gulp构建插件/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

        </div>
      </header>
    


    <div class="post-body">

      
      

      
        
          <span itemprop="articleBody">
            
              <p>gulp，主要用来前端项目开发过程中自动构建项目，自身的api比较简单，一般搭配着多种插件来使用，以最大限度满足项目的构建需要。<br>gulp跟grunt、webpack的功能差不多，grunt算是gulp的前辈吧，稍早先用grunt的可能比较多点，webpack目前比较火的原因可能也跟其与react天生一对有关，哥俩好。<br>本文暂不涉及grunt及webpack的知识，主要介绍两个主题，前一部分先简单介绍gulp的工作原理，后一部分将介绍我是怎么使用gulp的，可以概括为：用gulp构建angular项目中我主要涉及的需求、实现思路及插件。</p>
<h3 id="流(stream)">流(stream)</h3><p>在使用gulp之前，你先要了解下其工作原理，gulp核心思想之一便是：流。<br>通过<code>gulp.src</code>方法，将文件以流的形式返回、输出。</p>
<h3 id="管道(pipe)">管道(pipe)</h3><p>管道可以看成是流的运输工具吧，通过<code>.pipe</code>方法，可以将输入的流流转到他处进行其他操作，比如最简单的，将其写入文件。</p>
<h3 id="dest">dest</h3><p>大部分构建任务的最后一步处理可能都是写文件，或者写文件夹。通过<code>gulp.dest</code>方法，将初始文件进行相应的处理后，写入一个新文件(文件夹)中，或者覆盖原有文件。</p>
<h3 id="task">task</h3><p><code>gulp.task</code>可以用来定义一个任务，第一个参数为任务名称，第二个参数表示当前任务要执行的动作，为一个函数。</p>
<h3 id="基本构建需求">基本构建需求</h3><p>先说一般情况下最简单前端项目构建需求，可能包括js合并、压缩、混淆，css合并、压缩，然后支持开发和发布两套指令。<br>先介绍一个插件：<code>gulp-load-plugins</code>，它可以根据<code>package.json</code>文件，识别gulp插件，在代码中调用后，会将以gulp为前缀的gulp插件添加到返回的对象列表中，根据后面的名字驼峰表示法可以拿到此插件的导出对象。这个插件的好处在于如果代码中用到的gulp插件太多，可以不用一个个的写require代码来引用插件模块。</p>
<ul>
<li>文件合并<br><code>gulp-cancat</code>插件可以用于合并多个文件；</li>
<li>文件压缩、混淆<br>文件压缩的插件可能比较多，可以根据需要自己选择，目前js处理，选用 <code>gulp-uglify</code>，其可对js文件进行压缩及混淆两步处理；<br>css文件，选用<code>gulp-minify-css</code>来进行压缩处理；</li>
<li>两套指令<br>工作当中的指令是能够同时支持项目开发需要及发布需要，比较合适的方案是结合if条件判断及<code>gulp-if</code>插件俩个配合来实现。</li>
</ul>
<h3 id="进一步扩展">进一步扩展</h3><p>拿一个简单的angular项目来举例，需求可就不止上面这些。</p>
<ul>
<li>js依赖注入<br>使用<code>gulp-ng-annotate</code>插件可以方便在angular项目开发过程中动态依赖注入；</li>
<li>重命名<br>使用<code>gulp-rename</code>插件可以重命名文件；</li>
<li>生成.map文件<br>使用<code>gulp-sourcemaps</code>插件可以生成.map文件，可以用于混淆后的js文件快速定位问题；</li>
<li>less文件编译<br>使用<code>gulp-less</code>插件可以对项目中的.less文件进行编译成正常可使用的.css文件；</li>
<li>自动添加浏览器前缀<br>使用<code>gulp-autoprefixer</code>，可以给样式表动态自动添加浏览器前缀；</li>
<li>动态引用资源<br>使用<code>gulp-inject</code>，可以给指定的入口文件，如index.html，动态插入引用的资源文件，由于最终引用的资源文件可能不时的在更换文件名或者版本号来避免浏览器缓存等，因此使用动态插入引用既可以避免出错又提高工作效率；</li>
<li>html打包js<br>使用<code>gulp-angular-templatecache</code>，可以将项目中用到的html文件打包为js文件，生成的js文件包含html模版文件的cache，使用时只需要写入依赖即可；</li>
</ul>
<h3 id="最后">最后</h3><p>上述这些插件的合理使用可以基本服务一个angular项目的正常构建需要，但是当项目日益庞大，所需要的需求日加复杂的情况下，可能就需要在使用已有的插件搭配工作下进行自己的一些逻辑处理，下文将再对此做一个简单的思路介绍。</p>
<hr>
<hr>
<p><img src="../../../../images/money.png" alt="money">☜☜☜ <strong><em>wechat</em></strong> 『『『<strong><em> reward 点击扫码打赏 ~~~ ^_^ </em></strong>  』』』<strong><em>alipay</em></strong> ☞☞☞   <img src="../../../../images/money.jpg" alt="money"></p>
<hr>
<hr>

            
          </span>
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/07/07/使用node搭建简单web服务器/" itemprop="url">
                  使用node搭建简单web服务器
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            发表于
            <time itemprop="dateCreated" datetime="2016-07-07T17:23:58+08:00" content="2016-07-07">
              2016-07-07
            </time>
          </span>

          

          
            
              <span class="post-comments-count" style="display:none">
                &nbsp; | &nbsp;
                <a href="/2016/07/07/使用node搭建简单web服务器/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/07/07/使用node搭建简单web服务器/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

        </div>
      </header>
    


    <div class="post-body">

      
      

      
        
          <span itemprop="articleBody">
            
              <p>本文主题是使用node来搭建最简单的web服务器，其后可以自己根据需要深入了解，目前在开发过程中可以用来模拟与服务器进行简单的交互，比如返回的资源控制等。<br>早先不使用web服务器的情况下想要在浏览器端访问本地资源，可以利用firefox浏览器，其可以自己启动一个小型web服务器。<br>为了让刚接触node的人也能大体看懂，本文的代码我将尽量简化。</p>
<h3 id="准备">准备</h3><p>首先，需要安装<a href="https://nodejs.org/en/download/" target="_blank" rel="external">nodejs</a>，这个可以去官网下载，目前我本地安装的<code>v0.12</code>版本。<br>安装完成后可以通过命令行测试安装是否成功，输入：<code>node -v</code>，应该会显示当前安装<code>node版本号</code>。<br>本文中用到的模块，都是<code>nodejs</code>核心模块，不需要从外部下载，如果有需要，可以使用以下命令安装：<code>npm install xxx</code>。</p>
<h3 id="开始">开始</h3><p>下一步，新建<code>js</code>文件，可以命名为<code>server.js</code>，代码如下：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> http = <span class="built_in">require</span>(<span class="string">'http'</span>);</span><br><span class="line">   <span class="keyword">var</span> url = <span class="built_in">require</span>(<span class="string">'url'</span>);</span><br><span class="line">   <span class="keyword">var</span> path = <span class="built_in">require</span>(<span class="string">'path'</span>);</span><br><span class="line">   <span class="keyword">var</span> fs = <span class="built_in">require</span>(<span class="string">'fs'</span>);</span><br><span class="line"></span><br><span class="line">   <span class="keyword">var</span> dir, arg = process.argv[<span class="number">2</span>] || <span class="string">''</span>;	<span class="comment">// 命令行第三个参数，用来接收目录，可为空，相对当前server.js文件的目录名称</span></span><br><span class="line">					<span class="comment">// 比如使用命令 node server debug，意思就是debug文件夹与server.js文件同级</span></span><br><span class="line">					<span class="comment">// 且你想以debug文件夹启动web服务</span></span><br><span class="line"></span><br><span class="line">   http.createServer(<span class="function"><span class="keyword">function</span> (<span class="params">req, res</span>) </span>&#123;</span><br><span class="line">   	<span class="keyword">var</span> pathname = __dirname + url.parse(req.url).pathname;</span><br><span class="line">   	dir = dir ? dir : pathname;			<span class="comment">// 记住dir(目录)</span></span><br><span class="line">   	pathname = dir ? pathname.replace(dir, dir + arg + <span class="string">'/'</span>) : pathname;	<span class="comment">// 替换文件静态路径</span></span><br><span class="line">   	<span class="keyword">if</span> (path.extname(pathname) == <span class="string">""</span>) &#123;</span><br><span class="line">   		pathname += <span class="string">"/"</span>;</span><br><span class="line">   	&#125;</span><br><span class="line">   	<span class="keyword">if</span> (pathname.charAt(pathname.length - <span class="number">1</span>) == <span class="string">"/"</span>) &#123;</span><br><span class="line">   		pathname += <span class="string">"index.html"</span>;	<span class="comment">// 入口文件，此处默认index.html</span></span><br><span class="line">   	&#125;</span><br><span class="line"></span><br><span class="line">   	fs.exists(pathname, <span class="function"><span class="keyword">function</span> (<span class="params">exists</span>) </span>&#123;</span><br><span class="line">   		<span class="keyword">if</span> (exists) &#123;</span><br><span class="line">   			<span class="keyword">switch</span> (path.extname(pathname)) &#123;</span><br><span class="line">   				<span class="keyword">case</span> <span class="string">".html"</span>:</span><br><span class="line">   					res.writeHead(<span class="number">200</span>, &#123;<span class="string">"Content-Type"</span>: <span class="string">"text/html"</span>&#125;);</span><br><span class="line">   					<span class="keyword">break</span>;</span><br><span class="line">   				<span class="keyword">case</span> <span class="string">".js"</span>:</span><br><span class="line">   					res.writeHead(<span class="number">200</span>, &#123;<span class="string">"Content-Type"</span>: <span class="string">"text/javascript"</span>&#125;);</span><br><span class="line">   					<span class="keyword">break</span>;</span><br><span class="line">   				<span class="keyword">case</span> <span class="string">".css"</span>:</span><br><span class="line">   					res.writeHead(<span class="number">200</span>, &#123;<span class="string">"Content-Type"</span>: <span class="string">"text/css"</span>&#125;);</span><br><span class="line">   					<span class="keyword">break</span>;</span><br><span class="line">   				<span class="keyword">case</span> <span class="string">".gif"</span>:</span><br><span class="line">   					res.writeHead(<span class="number">200</span>, &#123;<span class="string">"Content-Type"</span>: <span class="string">"image/gif"</span>&#125;);</span><br><span class="line">   					<span class="keyword">break</span>;</span><br><span class="line">   				<span class="keyword">case</span> <span class="string">".jpg"</span>:</span><br><span class="line">   					res.writeHead(<span class="number">200</span>, &#123;<span class="string">"Content-Type"</span>: <span class="string">"image/jpeg"</span>&#125;);</span><br><span class="line">   					<span class="keyword">break</span>;</span><br><span class="line">   				<span class="keyword">case</span> <span class="string">".png"</span>:</span><br><span class="line">   					res.writeHead(<span class="number">200</span>, &#123;<span class="string">"Content-Type"</span>: <span class="string">"image/png"</span>&#125;);</span><br><span class="line">   					<span class="keyword">break</span>;</span><br><span class="line">   				<span class="keyword">default</span>:</span><br><span class="line">   					res.writeHead(<span class="number">200</span>, &#123;<span class="string">"Content-Type"</span>: <span class="string">"application/octet-stream"</span>&#125;);</span><br><span class="line">   			&#125;</span><br><span class="line"></span><br><span class="line">			<span class="comment">// res可以自己添加信息来简单交互 比如可以修改点header信息 或者修改返回的资源数据</span></span><br><span class="line">   			fs.readFile(pathname, <span class="function"><span class="keyword">function</span> (<span class="params">err, data</span>) </span>&#123;</span><br><span class="line">   				res.end(data);</span><br><span class="line">   			&#125;);</span><br><span class="line">   		&#125;</span><br><span class="line">   		<span class="keyword">else</span> &#123;</span><br><span class="line">   			res.writeHead(<span class="number">404</span>, &#123;<span class="string">"Content-Type"</span>: <span class="string">"text/html"</span>&#125;);</span><br><span class="line">   			res.end(<span class="string">"&lt;h1&gt;404 Not Found&lt;/h1&gt;"</span>);</span><br><span class="line">   		&#125;</span><br><span class="line">   	&#125;);</span><br><span class="line">   &#125;).listen(<span class="number">8085</span>, <span class="string">"127.0.0.5"</span>);	<span class="comment">// 服务器端口</span></span><br><span class="line"></span><br><span class="line">   <span class="built_in">console</span>.log(<span class="string">"server running at http://127.0.0.5:8085/"</span>);</span><br></pre></td></tr></table></figure></p>
<h3 id="启动">启动</h3><p>当<code>node</code>安装完成及上述<code>server.js</code>文件也新建好之后。将其与你要访问的文件夹放在一起，可以放同层或者直接下层。比如，如果你要访问<code>d:\test\debug</code>文件夹。<br>你可以先将当前文件放入同层或者直接下，然后输入如下命令启动<code>web</code>服务：<br><figure class="highlight autohotkey"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">先打开<span class="escape">`c</span>md<span class="escape">`，</span>进入server文件所在目录，比如是<span class="escape">`t</span>est<span class="escape">`目</span>录；</span><br><span class="line">然后输入：<span class="escape">`n</span>ode server debug<span class="escape">`(</span>同层), 或者<span class="escape">`n</span>ode server<span class="escape">`(</span>子层),</span><br><span class="line"><span class="label">此时会提示`server running at http://127.0.0.5:</span><span class="number">8085</span>/<span class="escape">`,</span> 表示启动服务成功；</span><br><span class="line"><span class="label">最后打开浏览器，进入：`127.0.0.5:</span><span class="number">8085</span><span class="escape">`，</span>即可访问此资源。</span><br></pre></td></tr></table></figure></p>
<h3 id="最后">最后</h3><p>简单解释下上面的代码。</p>
<ul>
<li>首先最上面的<code>require</code>表示需要用到那几个模块，先引用一下；</li>
<li><code>arg</code>表示输入的命令行的第三个参数，上面是做了手动截取；</li>
<li><code>createServer</code>方法表示创建一个http服务，以函数为参数，本文代码中传入了一个匿名函数；<ul>
<li><code>req</code>，表示http request(请求)对象，其携带着来自客户端此次http请求的相关信息，例如请求method、请求query参数、请求header头信息等；</li>
<li><code>res</code>，表示http response(返回)对象，用来给客户端返回请求资源用，可以手动添加信息，例如返回的数据、返回的头信息等、返回的code等；</li>
<li><code>fs</code>，表示文件资源对象，具体可以访问<a href="https://nodejs.org/en/docs/" target="_blank" rel="external">nodejs官网的api</a>；</li>
<li><code>path</code>，表示资源路径对象，具体可以访问<a href="https://nodejs.org/en/docs/" target="_blank" rel="external">nodejs官网的api</a>。</li>
</ul>
</li>
<li><code>listen</code>表示创建的服务监听，一旦访问了此端口，将进入此前的匿名函数回调中，将资源返回给客户端。</li>
</ul>
<hr>
<hr>
<p><img src="../../../../images/money.png" alt="money">☜☜☜ <strong><em>wechat</em></strong> 『『『<strong><em> reward 点击扫码打赏 ~~~ ^_^ </em></strong>  』』』<strong><em>alipay</em></strong> ☞☞☞   <img src="../../../../images/money.jpg" alt="money"></p>
<hr>
<hr>

            
          </span>
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/06/03/angular项目涉及多个应用的目录结构划分参考/" itemprop="url">
                  angular项目涉及多个应用的目录结构划分参考
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            发表于
            <time itemprop="dateCreated" datetime="2016-06-03T14:26:31+08:00" content="2016-06-03">
              2016-06-03
            </time>
          </span>

          

          
            
              <span class="post-comments-count" style="display:none">
                &nbsp; | &nbsp;
                <a href="/2016/06/03/angular项目涉及多个应用的目录结构划分参考/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/06/03/angular项目涉及多个应用的目录结构划分参考/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

        </div>
      </header>
    


    <div class="post-body">

      
      

      
        
          <span itemprop="articleBody">
            
              <p>一般的angular项目都是单页应用，但是当项目逐渐庞大时，可能会需要拆分多个应用来具体实现。近期花时间将原有的项目结构进行改造，以便进行多应用开发，下图是我设计的初版项目目录结构，希望可以给有需要的人一点帮助。</p>
<p><code class="normal-img"><img src="../../../../images/20160603/structure.png" alt="structure"></code></p>
<hr>
<hr>
<p><img src="../../../../images/money.png" alt="money">☜☜☜ <strong><em>wechat</em></strong> 『『『<strong><em> reward 点击扫码打赏 ~~~ ^_^ </em></strong>  』』』<strong><em>alipay</em></strong> ☞☞☞   <img src="../../../../images/money.jpg" alt="money"></p>
<hr>
<hr>

            
          </span>
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/04/29/关于登录页面的一些事儿/" itemprop="url">
                  你以为BAT的登录天衣无缝?
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            发表于
            <time itemprop="dateCreated" datetime="2016-04-29T14:32:12+08:00" content="2016-04-29">
              2016-04-29
            </time>
          </span>

          

          
            
              <span class="post-comments-count" style="display:none">
                &nbsp; | &nbsp;
                <a href="/2016/04/29/关于登录页面的一些事儿/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/04/29/关于登录页面的一些事儿/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

        </div>
      </header>
    


    <div class="post-body">

      
      

      
        
          <span itemprop="articleBody">
            
              <p><strong><small style="font-weight:100;color:rgba(255,128,0,1)">以下皆为个人原创见解，不当之处烦请指正。</small></strong></p>
<p>首先，我有些话想说在前面。现在网上的各种开放的资源，很多都是有访客模式，即不用登录也能浏览或者操作，但是现今时代没有登录功能或者登录页面的网站，几乎绝迹了。<br>说实话，登录页面除了验证信息作用外，其他的都不是主要的，因此可能很多人觉得没有必要花很多时间在这上面。<br>我也同意上述观点！<br>但是呢，既然做了，当然希望做的更好点啦，废话不说，下面进入主题。</p>
<h3 id="吐槽">吐槽</h3><p>各大公司的网站，做的已经非常棒了，至少我是很佩服。<br>但是有时候会遇到一点小瑕疵，比如说下面几个例子，我平时也会拿出来吐槽下，用以慰藉下像我这种技术渣幼小的心灵。</p>
<ul>
<li><strong><em>JD</em></strong></li>
</ul>
<ol>
<li>JD的登录页面，如果没输入用户名和密码，或者只输入密码，点击登录按钮，会请求服务器拿两个log.gif文件，我并不知道这个文件是干嘛用的，为什么要这么做。然后当输入了用户名再删去，也会发出请求。不是应该只有都输了，才发出请求的吗???<hr style="background-color:#CFE8A8;margin:5px 0;"></li>
<li>第二点，就是点击右下角扫码登录后，按钮居然跑下面来了，居然不是在同一个地方，每次点完都要移动鼠标才能点回去，这体验太差了吧。<hr style="background-color:#CFE8A8;margin:5px 0;"></li>
<li>第三点，从普通登录切换扫码登录，拿一个code图片，我能理解，但是为什么切回来的时候，还要拿一次吖？？？<hr style="background-color:#CFE8A8;margin:5px 0;"></li>
<li>第四点，登录页面没有做自适应处理，缩放后出现滚动条。</li>
</ol>
<ul>
<li><strong><em>BD</em></strong><br>BD的登录弹框，每次修改完密码再失焦，会请求一次publicKey。然后从扫码登录页面切换回来，也还会再请求一次gif文件。但至少切换的按钮，位置没变，不需要再移动鼠标。也没有做自适应处理，缩放屏幕出现滚动条。</li>
<li><strong><em>ALI</em></strong></li>
</ul>
<ol>
<li>TB的登录页面做了自适应，有一个767的分界。屏宽小于767px，会让登录窗口居中显示，去掉背景。<br>但是关于TB登录页面的自适应做的，也有问题。当屏宽超过767px时，由于其左边的背景看着像是广告图片，图片的宽度设置为屏宽100%，而整个页面内容区域宽度也是固定的，目前是1200px，当屏宽在767与1200之间时，还是出现了横向滚动条。<br>关键的来了，由于TB登录框的position是relative，此时被固定在右侧了，你要看到首先得拖动滚动条，一拖滚动条，背景就跟不过来了，就会很容易出现我看到登录框整个背景是白色的！<br>或者部分背景是白色的！没有背景！或者说脱离背景图片了！这个看着视觉效果太差了感觉。<hr style="background-color:#CFE8A8;margin:5px 0;"></li>
<li>第二点，当我输入用户名和密码后，不管我有没有拖动验证条，都会去执行登录请求服务器。而且我很奇怪的是，登录失败也要整个页面重新刷新一次！！！<br>我的天呐，我不知道为什么需要重新刷新一次，而且我感觉好像是有意为之，因为登录失败再加载页面很慢，还有专门的加载进度圈圈。。。</li>
</ol>
<h3 id="界面">界面</h3><p>吐槽完了，说下我自己写的渣渣页面吧。由于h5很多元素用的不多，语义性可能有点乱，但是大致思想在那。<br>首先界面，主要是三块，header、section及footer，大致如下：<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--login header--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">header</span> <span class="attribute">class</span> = "<span class="attribute">login-header</span>"&gt;</span></span><br><span class="line">	  <span class="comment">&lt;!--login logo--&gt;</span></span><br><span class="line">	  <span class="tag">&lt;<span class="title">div</span> <span class="attribute">class</span> = "<span class="attribute">login-logo</span>"&gt;</span></span><br><span class="line">		...</span><br><span class="line">	  <span class="tag">&lt;/<span class="title">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">header</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--login content--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">section</span> <span class="attribute">class</span> = "<span class="attribute">login-content</span>"&gt;</span></span><br><span class="line">  <span class="comment">&lt;!--login background--&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="title">div</span> <span class="attribute">class</span> = "<span class="attribute">login-bg</span>"&gt;</span></span><br><span class="line">  	...</span><br><span class="line">  <span class="tag">&lt;/<span class="title">div</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!--login layout--&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="title">div</span> <span class="attribute">class</span> = "<span class="attribute">login-layout</span>"&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="title">div</span> <span class="attribute">class</span> = "<span class="attribute">login-box-wrap</span>"&gt;</span></span><br><span class="line">		...</span><br><span class="line">	<span class="tag">&lt;/<span class="title">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="title">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">section</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--login footer--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">footer</span> <span class="attribute">class</span> = "<span class="attribute">login-footer</span>"&gt;</span></span><br><span class="line">	...</span><br><span class="line"><span class="tag">&lt;/<span class="title">footer</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>header部分现在是放一个logo区域。<br>footer部门现在是放一些友链啥的。<br>section是主要内容区域。内容区域放一个可以独立出来的弹出框，因为有些网站，像BD，可能不光有登录页面，还有登录弹框。<br>单独拿出来可以保证此页面可以复用，比如项目是用ng开发的时候，写成指令。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="title">div</span> <span class="attribute">class</span> = "<span class="attribute">login-box</span>"&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="title">div</span> <span class="attribute">class</span> = "<span class="attribute">login-box-content</span>"&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--login quick--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">div</span> <span class="attribute">class</span> = "<span class="attribute">login-quick</span>"&gt;</span></span><br><span class="line">    	...</span><br><span class="line">    <span class="tag">&lt;/<span class="title">div</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--login static form--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">form</span> <span class="attribute">class</span> = "<span class="attribute">login-static</span>" <span class="attribute">submit</span> = "<span class="attribute">signIn</span>();"&gt;</span></span><br><span class="line">    	... (账户)</span><br><span class="line">    	... (密码)</span><br><span class="line">    	... (验证码)</span><br><span class="line">      <span class="comment">&lt;!--login button--&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="title">div</span> <span class="attribute">class</span> = "<span class="attribute">login-btn</span>"&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">button</span> <span class="attribute">type</span> = "<span class="attribute">submit</span>" <span class="attribute">class</span> = "<span class="attribute">btn</span> <span class="attribute">btn-success</span>"&gt;</span>登 录<span class="tag">&lt;/<span class="title">button</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="title">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="title">form</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="title">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">div</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="自适应&amp;视效(样式)">自适应&amp;视效(样式)</h3><p>可能不算视效啦，只是不知道怎么描述。<br>首先，内容区域，即section部分，我设置position为relative，相对定位。宽度100%。背景图片宽度100%，绝对定位。<br>添加媒介查询，屏宽小于768px时，背景不要了。<br><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="class">.login-content</span> &#123;</span><br><span class="line">       <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">       <span class="attribute">position</span>: relative;</span><br><span class="line">   &#125;</span><br><span class="line"><span class="at_rule">@media</span> (<span class="attribute">min-width</span>: <span class="number">768px</span>)</span><br><span class="line">   .login-bg&#123;</span><br><span class="line">       <span class="attribute">position</span>: absolute;</span><br><span class="line">       <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure></p>
<p>然后登录内容区域，宽度先固定1200px，相对定位。先保证在大屏幕情况下，正常显示，再去滚动条。<br><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="class">.login-layout</span><span class="rules">&#123;</span><br><span class="line">	<span class="rule"><span class="attribute">width</span>:<span class="value"> <span class="number">1200px</span></span></span>;</span><br><span class="line">	<span class="rule"><span class="attribute">margin</span>:<span class="value"> <span class="number">0</span> auto</span></span>;</span><br><span class="line">	<span class="rule"><span class="attribute">overflow</span>:<span class="value"> hidden</span></span>;</span><br><span class="line">	<span class="rule"><span class="attribute">position</span>:<span class="value"> relative</span></span>;</span><br><span class="line">	<span class="rule"><span class="attribute">transition</span>:<span class="value"> width .<span class="number">25s</span> linear</span></span>;</span><br><span class="line">&#125;</span></span><br></pre></td></tr></table></figure></p>
<p>注意最后一行，我还加了点别的东西–transition，这个小过渡主要是变化窗体宽度的时候触发。<br>有人会说我width固定了，也触发不了呀，下面还有一点东西。<br><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="at_rule">@media</span> (<span class="attribute">max-width</span>: <span class="number">1200px</span>) and (<span class="attribute">min-width</span>: <span class="number">768px</span>)</span><br><span class="line">   .login-layout &#123;</span><br><span class="line">       <span class="attribute">width</span>: <span class="number">100%</span>!important;</span><br><span class="line">  	&#125;</span><br></pre></td></tr></table></figure></p>
<p>上面这句样式的作用就是用来动态改变登录内容区域宽度的。这句样式个人感觉还是蛮重要的，可以保证屏宽在这两者之间时，内容区域宽度动态变化，这样做的好处就在于里面的子元素相对其定位时，感觉上子元素所处的位置没有发生变化。<br>接下来看下登录框的样式。<br><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="class">.login-box-wrap</span> <span class="rules">&#123;</span><br><span class="line">       <span class="rule"><span class="attribute">position</span>:<span class="value"> absolute</span></span>;</span><br><span class="line">       <span class="rule"><span class="attribute">top</span>:<span class="value"> <span class="number">40px</span></span></span>;</span><br><span class="line">       <span class="rule"><span class="attribute">right</span>:<span class="value"> <span class="number">15%</span></span></span>;</span><br><span class="line">&#125;</span></span><br></pre></td></tr></table></figure></p>
<p>相对父元素(此处为登录内容区域)，加一个top和right，以保证在宽度变化的时候，视觉上看登录框所处位置不变。<br>以上样式生效后，可以保证屏宽在768px以下时，只居中显示登陆框，在1200px以上时，正常显示。在两者之间时，屏宽有变化则登录窗体也跟着一起变化，不出现滚动条，背景不丢失，且登录框所处位置相对固定。</p>
<h3 id="登录(功能)">登录(功能)</h3><p>h5提供一些基础的表单校验功能，其中有一条–必填检验(required)。而且允许用户自定义一些校验提示，还支持正则匹配。此特性规定，在校验不合法的情况下，不允许用户提交表单。<br>因此我在form内利用这些新知识，可以避免在没有输入用户及密码的情况下，进行表单提交，请求后台服务器。我不知道其他网站为何要在未输入用户名密码的情况下请求后台服务器，我觉得在我看来没有这个必要。<br><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;input <span class="class"><span class="keyword">type</span> =</span> <span class="string">"text"</span></span><br><span class="line">	<span class="class"><span class="keyword">class</span> =</span> <span class="string">"form-control"</span> required autofocus = <span class="string">"autofocus"</span></span><br><span class="line">	autocomplete=<span class="string">"on"</span> placeholder = <span class="string">"手机号/会员名/邮箱"</span></span><br><span class="line">    oninvalid = <span class="string">"setCustomValidity('请输入账号')"</span></span><br><span class="line">    oninput = <span class="string">"setCustomValidity('')"</span></span><br><span class="line">/&gt;</span><br></pre></td></tr></table></figure></p>
<p>‘autofocus’属性可以让当前元素在页面初始化的时候，自动获取焦点。<br>‘autocomplete’设置为on可以让浏览器记住输入内容。<br>‘oninvalid’属性可以自己设定输入非法时的提示语。<br>‘oninput’属性表示输入时要执行的操作。<br>‘placeholder’属性表示占位时显示的字符。</p>
<p>这些都是普通的h5新特性，可以添加你们适用的属性来满足需求，个人感觉还比较方便。</p>
<h3 id="安全">安全</h3><p>目前登录机制是利用cookie。有时候可能需要跳转到当前系统，即利用单点登录验证身份，此时是请求服务器产生一个唯一的一次可用的authId，携带这个authId的即视为合法用户。登录安全这块内容东西太多，做的时候需要考虑仔细点，以上就是登录页面我个人的看法。</p>
<hr>
<hr>
<p><img src="../../../../images/money.png" alt="money">☜☜☜ <strong><em>wechat</em></strong> 『『『<strong><em> reward 点击扫码打赏 ~~~ ^_^ </em></strong>  』』』<strong><em>alipay</em></strong> ☞☞☞   <img src="../../../../images/money.jpg" alt="money"></p>
<hr>
<hr>

            
          </span>
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/04/01/高性能网站建设指南-笔记/" itemprop="url">
                  高性能网站建设指南(笔记)
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            发表于
            <time itemprop="dateCreated" datetime="2016-04-01T10:52:53+08:00" content="2016-04-01">
              2016-04-01
            </time>
          </span>

          

          
            
              <span class="post-comments-count" style="display:none">
                &nbsp; | &nbsp;
                <a href="/2016/04/01/高性能网站建设指南-笔记/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/04/01/高性能网站建设指南-笔记/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

        </div>
      </header>
    


    <div class="post-body">

      
      

      
        
          <span itemprop="articleBody">
            
              <p>本文为Steve Souders的《High Performance Web Sites》读书笔记，主要介绍14条用于前端优化网站性能的建议。</p>
<h3 id="Rule_1:_Make_Fewer_HTTP_Requests(减少HTTP请求)">Rule 1: Make Fewer HTTP Requests(减少HTTP请求)</h3><ul>
<li><strong><em>Image Maps</em></strong><br>在看到这个名词之前，甚至没听说过它。稍微了解了下，知道大概就是可以用一张图片当成地图，然后点击图片上某一点，触发相应的事件。用到的场景可以是电商的服装广告上，比如一张模特图片，点击衣服，跳转衣服链接，点击鞋子，跳转鞋子链接。也可以是导航为图片的情况，点击导航对应的信息，相应执行动作。<br>使用图片地图可以减少多张图片进行多次HTTP请求。<br><a href="http://stevesouders.com/hpws/imagemap-no.php" target="_blank" rel="external">example for no</a><br><a href="http://stevesouders.com/hpws/imagemap.php" target="_blank" rel="external">example for yes</a></li>
<li><strong><em>CSS Sprites</em></strong><br>这个比较常用在图片图标情况下。<br><a href="http://stevesouders.com/hpws/sprites.php" target="_blank" rel="external">example for yes</a></li>
<li><strong><em>Inline Images</em></strong><br>可以使用“data:”内联图片，不用额外再去请求图片。<br><a href="http://stevesouders.com/hpws/inline-images.php" target="_blank" rel="external">example for html yes</a><br><a href="http://stevesouders.com/hpws/inline-css-images.php" target="_blank" rel="external">example for css yes</a></li>
<li><strong><em>Combined Scripts and Stylesheets</em></strong><br>可以使用一些工具，如webpack/gulp，将脚本合并，样式表合并。虽然两者还可以合并，但不建议这么做。<br><a href="http://stevesouders.com/hpws/combo-none.php" target="_blank" rel="external">example for no</a><br><a href="http://stevesouders.com/hpws/combo.php" target="_blank" rel="external">example for yes</a></li>
</ul>
<h3 id="Rule_2:_Use_a_Content_Delivery_NetWork(使用内容分发网络)">Rule 2: Use a Content Delivery NetWork(使用内容分发网络)</h3><ul>
<li><strong><em>CND</em></strong><br>先要了解下CND–内容分发网络。它是一组分布在多个不同地理位置的Web服务器，可以更加有效的向用户发布内容。个人感觉最简单的解释就是可以让用户就近请求资源。</li>
</ul>
<h3 id="Rule_3:_Add_an_Expires_Header(添加Expires头)">Rule 3: Add an Expires Header(添加Expires头)</h3><ul>
<li><strong><em>Expires</em></strong><br>Web服务器使用Expires来告诉客户端该资源在某时间之前是有效的。客户端在服务端没有更新资源的情况下，可以在这段时间内一直使用之前请求到的资源的副本。</li>
<li><strong><em>Max-Age &amp; mod_expires</em></strong><br>使用Expires有一些限制，比如需要客户端和服务端的时钟需要严格同步，然后还要经常检查过期日期，一旦过期，还得提供一个新的日期。<br>在HTTP1.1种，引入了Cache-Control。这时我们可以换一种方式，使用Cache-Control的Max-Age替代Expires。它表示资源可以被缓存多长时间，以s为单位。<br>为了兼容，可以同时指定这两个响应头。HTTP规范规定，如果这两者同时存在，Max-Age将重写Expires。</li>
<li><strong><em>Empty Cache vs Primed Cache</em></strong><br>如果你的页面中可缓存资源都在缓存中，则缓存是“完整的”。如果你页面中的资源没有放在缓存中，则缓存为“空”。这两者使用场景不一样，使用时，视情况而定。</li>
<li><strong><em>More Than Just Images</em></strong><br>图片添加Expires很正常，我们也应该给其他不经常变化的资源添加Expires，比如脚本、样式表等。</li>
<li><strong><em>Revving FileNames</em></strong><br>如果像上面那样给资源添加Expires，那么怎样让其获取更新呢？一般的实现是替换文件名，加一个版本信息后缀。</li>
</ul>
<h3 id="Rule_4:_Gzip_Components(压缩组件)">Rule 4: Gzip Components(压缩组件)</h3><ul>
<li><strong><em>How Cpmpression Works</em></strong><br>Web客户端可以通过HTTP请求中的Accept-Encoding头来标识对压缩的支持。如果Web服务器看到请求中的这个头，就会使用客户端列出来所支持的一种压缩方法来响应。<br>Web服务器通过响应中的Content-Encoding头来通知Web客户端。gzip是目前最流行和最有效的压缩方法，还有一种较普遍的压缩格式为deflate。支持deflate的浏览器也支持gzip，但支持gzip的浏览器却不一定支持deflate。</li>
</ul>
<h3 id="Rule_5:_Put_Stylesheets_at_the_Top(将样式表放在顶部)">Rule 5: Put Stylesheets at the Top(将样式表放在顶部)</h3><ul>
<li><strong><em>Progressive Rendering</em></strong><br>将样式表放在文档底部时，浏览器会延迟显示任何可视化的组件，这带来了很糟糕的用户体验，有时甚至会带来“白屏”现象。一般我们把样式表都放在文档的顶部。</li>
<li><strong><em>Flash of Unstyled Content</em></strong><br>“白屏”现象源自于浏览器的行为。“FOUC”–“无样式内容的闪烁”，简单说就是当样式加载完成，某组件会突然加载上某个样式，出现闪烁现象。<br>“白屏”现象是浏览器在尝试修改前端工程师所犯的错误–延迟呈现。</li>
<li><strong><em>What’s a Frontend Engineer to do?</em></strong><br>如何避免“白屏”和“FOUC”现象呢？<br>最佳的解决方案是遵循HTML规范，将样式表放在顶部。如果你的样式表不要求呈现页面，可以想办法在文档加载完毕后动态的加载进来，即“加载后下载”。</li>
</ul>
<h3 id="Rule_6:_Put_Scripts_at_the_Bottom(将脚本放在底部)">Rule 6: Put Scripts at the Bottom(将脚本放在底部)</h3><ul>
<li><strong><em>Parallel Downloads</em></strong><br>对响应时间影响最大的是页面中组件的数量。浏览器可并行下载组件数量有限，可能4个，可能8个。修改浏览器设置可能可以增加并行下载数量。但这个取决于你的带宽和CPU速度，过多的并行下载可能反而会降低性能。</li>
<li><strong><em>Scripts Block Downloads</em></strong><br>在下载脚本时，浏览器会阻塞并行下载。其中一个原因就是为了保证脚本能够按照正确的顺序执行。另一个原因是脚本可能使用document.write来修改页面内容，因此浏览器会等待，以确保页面能够恰当的布局。</li>
<li><strong><em>Worst Case: Scripts at the Top</em></strong><br>如果将脚本放在页面顶部，页面中的所有东西都位于脚本之后，那么整个页面的呈现和下载都会被阻塞，直至脚本加载完毕。</li>
<li><strong><em>Best Case: Scripts at the Bottom</em></strong><br>将脚本放在页面的底部是最佳的方案，既不会阻止页面内容的呈现，还可以让页面中的可视化组件尽早下载。</li>
<li><strong><em>Putting it in Perspective</em></strong><br>如果某个脚本下载等待时间很长，但我们不想等待这么长时间。那么可以使用Defferred(延迟)脚本。DEFER属性表明脚本不包含document.write，浏览器可以继续呈现。</li>
</ul>
<h3 id="Rule_7:_Avoid_CSS_Expressions(避免CSS表达式)">Rule 7: Avoid CSS Expressions(避免CSS表达式)</h3><ul>
<li><strong><em>Working Around the Problem</em></strong><br>如果需要动态改变样式，可以使用事件处理器。</li>
</ul>
<h3 id="Rule_8:_Make_JavaScript_and_CSS_External(使用外部JavaScript和CSS)">Rule 8: Make JavaScript and CSS External(使用外部JavaScript和CSS)</h3><ul>
<li><strong><em>Inline</em></strong><br>内联快一些。</li>
<li><strong><em>Component Reuse</em></strong><br>如果你的网站中的每个页面或者多个页面都使用了相同的JavaScript和CSS，使用外部文件可以提高这些组件的重用性，这时，使用外部文件更加具有优势。</li>
<li><strong><em>Post-Onload Download</em></strong><br>我们希望为主页内联JavaScript和CSS，但又能为所有后续页面查看提供外部文件。这时可以通过在主页加载完成后动态下载外部组件来实现(通过onload事件)，这能够将外部文件放到浏览器的缓存中以便用户接下来访问其他页面。<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="title">script</span>&gt;</span><span class="javascript"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">doOnload</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    setTimeout(downloadComponents(),<span class="number">1000</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">downloadComponents</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    downloadJS(<span class="string">'http://xxx/xxx.js'</span>);</span><br><span class="line">    downloadCSS(<span class="string">'http://xxx/xxx.css'</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">downloadJS</span>(<span class="params">url</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">var</span> elem = <span class="built_in">document</span>.createElement(<span class="string">'script'</span>);</span><br><span class="line">    elem.src = url;</span><br><span class="line">    <span class="built_in">document</span>.body.appendChild(elem);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">downloadCSS</span>(<span class="params">url</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">var</span> elem = <span class="built_in">document</span>.createElement(<span class="string">'link'</span>);</span><br><span class="line">    elem.rel = <span class="string">'stylesheet'</span>;</span><br><span class="line">    elem.type = <span class="string">'text/css'</span>;</span><br><span class="line">    elem.href = url;</span><br><span class="line">    <span class="built_in">document</span>.body.appendChild(elem);</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">window</span>.onload = doOnload;</span><br><span class="line"></span><span class="tag">&lt;/<span class="title">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="Rule_9:_Reduce_DNS_lookups(减少DNS查找)">Rule 9: Reduce DNS lookups(减少DNS查找)</h3><ul>
<li><strong><em>DNS Caching and TTLs</em></strong><br>DNS查找可以被缓存起来以提高性能。<br>在用户请求一个主机名之后，DNS信息会留在操作系统的DNS缓存中，之后对于该主机名的请求将无需进行过多的DNS查找。<br>很多浏览器拥有其自己的缓存，和操作系统的缓存相分离。只要浏览器在其缓存中保留了DNS记录，它就不会麻烦操作系统来请求这个记录。</li>
</ul>
<h3 id="Rule_10:_Minify_JavaScript(精简JavaScript)">Rule 10: Minify JavaScript(精简JavaScript)</h3><ul>
<li><strong><em>Minification</em></strong><br>精简，是从代码中移除不必要的字符以减少其大小，所有的注释以及不必要的空白字符将被移除。</li>
<li><strong><em>Obfuscation</em></strong><br>混淆，同精简一样，它也会移除注释和空白，但同时它也会改写代码，它会使用更短的变量和函数名字替换原有内容。</li>
<li><strong><em>Gzip and Minification</em></strong><br>使用gzip压缩文件，通常可以使文件大小减小70%，压缩比精简更能减小文件的大小。而且，混淆压缩与精简压缩，效率几乎一样。但使用精简可以避免混淆带来的额外风险。</li>
<li><strong><em>Minifying CSS</em></strong><br>优化CSS，最大的潜在可能是，合并相同的类、移除不使用的类等。目前的解决方案是移除注释和空白，并进行一些直观的优化，比如使用缩写(‘#ccc’代替’#cccccc’)和移除不必要的字符串，如用’0’代替’0px’。</li>
</ul>
<h3 id="Rule_11:_Avoid_Redirects(避免重定向)">Rule 11: Avoid Redirects(避免重定向)</h3><ul>
<li><strong><em>Types of Redirects</em></strong><br>重定向请求的响应中会包含一个范围在3xx的状态码。’304 Not Modified’并不是真的重定向–它是用来响应条件GET请求，避免下载已经存在于浏览器缓存中的数据。状态码’306’已经被废弃。</li>
<li><strong><em>How Redirects Hurt Performance</em></strong><br>第一次请求URL时，接收到3xx重定向，然后请求此时的新url，而且可能会多次重定向，此时直到请求到预期想请求的资源已经经过了好几次http请求，影响性能。</li>
</ul>
<h3 id="Rule_12:_Remove_Duplicate_Scripts(移除重复脚本)">Rule 12: Remove Duplicate Scripts(移除重复脚本)</h3><ul>
<li><strong><em>Duplicate Scripts Hurt Performance</em></strong><br>重复脚本损伤性能的方式有两种–不必要的HTTP请求和执行JavaScript所浪费的时间。</li>
</ul>
<h3 id="Rule_13:_Configure_ETags(配置ETag)">Rule 13: Configure ETags(配置ETag)</h3><ul>
<li><strong><em>What’s an ETag</em></strong><br>实体标签，是Web服务器和浏览器用于确认缓存组件的有效性的一种机制，在HTTP1.1中引入。</li>
<li><strong><em>Last Modified Date</em></strong><br>服务器通过Last-Modified响应头来返回组件的最新修改日期，下一次请求资源时，浏览器会使用If-Modified-Since头将最新修改日期传回到服务器以进行比较。<br>如果服务器上组件的最新修改日期与浏览器传回的值匹配，会返回一个304响应，而不会传送当前浏览器请求的资源。</li>
<li><strong><em>The Problem with ETags</em></strong><br>当浏览器从一台服务器上获取了原始组件，之后又向另外一台不同的服务器发起GET请求时，ETag是不会匹配的，这对于使用服务器集群来处理请求的网站来说，是很常见的一种情况。</li>
</ul>
<h3 id="Rule_14:_Make_Ajax_Cacheable(使Ajax可缓存)">Rule 14: Make Ajax Cacheable(使Ajax可缓存)</h3><ul>
<li><strong><em>Optimizing Ajax Requests</em></strong><br>当用户发起主动Ajax请求时，用户可能仍须等待，要改善性能，可以优化这些请求。</li>
<li><strong><em>Caching Ajax in the Real World</em></strong><br>一个例子，Yahoo Mail。当用户启动Yahoo Mail的Ajax版本时，它会下载前三个Email消息的正文，这是一个聪明的主动Ajax请求，用户很有可能单击这些Email消息中的一个或几个，<br>它们已经被下载到客户端，这样用户无需进行任务Ajax请求就能看到他们的Email消息。</li>
</ul>
<hr>
<hr>
<p><img src="../../../../images/money.png" alt="money">☜☜☜ <strong><em>wechat</em></strong> 『『『<strong><em> reward 点击扫码打赏 ~~~ ^_^ </em></strong>  』』』<strong><em>alipay</em></strong> ☞☞☞   <img src="../../../../images/money.jpg" alt="money"></p>
<hr>
<hr>

            
          </span>
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/02/29/兼容AMD-CMD-CommonJS-Node-多种模块规范/" itemprop="url">
                  实现兼容AMD/CMD/Node多种模块规范
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            发表于
            <time itemprop="dateCreated" datetime="2016-02-29T22:43:01+08:00" content="2016-02-29">
              2016-02-29
            </time>
          </span>

          

          
            
              <span class="post-comments-count" style="display:none">
                &nbsp; | &nbsp;
                <a href="/2016/02/29/兼容AMD-CMD-CommonJS-Node-多种模块规范/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/02/29/兼容AMD-CMD-CommonJS-Node-多种模块规范/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

        </div>
      </header>
    


    <div class="post-body">

      
      

      
        
          <span itemprop="articleBody">
            
              <p>在JavaScript社区，CommonJS规范的提出，是模块化方面最重要的一笔。</p>
<h3 id="CommonJS的模块实现">CommonJS的模块实现</h3><p>CommonJS的模块引用使用require，如下：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> http = <span class="built_in">require</span>(<span class="string">'http'</span>);</span><br></pre></td></tr></table></figure></p>
<h3 id="Node的模块实现">Node的模块实现</h3><p>在Node中引入模块，需要经过下面3个步骤：</p>
<ul>
<li>路径分析；</li>
<li>文件定位；</li>
<li>编译执行。</li>
</ul>
<p>主要用require()方法来查找模块。</p>
<h3 id="AMD规范">AMD规范</h3><p>AMD全称Asynchronous Module Definition，即“异步模块定义”。其模块引用方式如下：<br><figure class="highlight puppet"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">define</span>(<span class="title">id</span>?,dependencies?,factory);</span><br></pre></td></tr></table></figure></p>
<p>其中，id及依赖是可选的。其与CommonJS方式相似的地方在于factory的内容就是实际代码的内容，下面是一个简单的例子：<br><figure class="highlight actionscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">define(<span class="function"><span class="keyword">function</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">var</span> exports = &#123;&#125;;</span><br><span class="line">	exports.sayHello = <span class="function"><span class="keyword">function</span><span class="params">()</span></span>&#123;</span><br><span class="line">		alert(<span class="string">'hello'</span>);</span><br><span class="line">	&#125;;</span><br><span class="line">	<span class="keyword">return</span> exports;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></p>
<h3 id="CMD规范">CMD规范</h3><p>CMD由国内大神玉伯提出，与AMD类似，区别主要在于定义模块和依赖引入的地方。AMD需要在声明模块时指定所有的依赖，通过形参传递依赖到模块内容中：<br><figure class="highlight actionscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">define([<span class="string">'dep1'</span>,<span class="string">'dep2'</span>],<span class="function"><span class="keyword">function</span><span class="params">(dep1,dep2)</span></span>&#123;</span><br><span class="line">	<span class="keyword">return</span> <span class="function"><span class="keyword">function</span><span class="params">()</span></span>&#123;&#125;;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></p>
<p>与AMD相比，CMD更接近Node对CommonJS规范的定义：<br><figure class="highlight puppet"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">define</span>(<span class="title">factory</span>);</span><br></pre></td></tr></table></figure></p>
<p>在依赖部分，CMD支持动态引入，如下：<br><figure class="highlight oxygene"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">define(<span class="function"><span class="keyword">function</span><span class="params">(<span class="keyword">require</span>,exports,<span class="keyword">module</span>)</span><span class="comment">&#123;</span><br><span class="line">	// Todo</span><br><span class="line">&#125;</span>);</span></span><br></pre></td></tr></table></figure></p>
<p>require、exports、module通过形参传递给模块，在需要依赖模块时，随时调用require引入即可。</p>
<h3 id="兼容多种模块规范">兼容多种模块规范</h3><p>为了让同一个模块可以运行在前后端，在开发过程中需要考虑兼容前后端问题，以下代码演示如何将hello()方法定义到不同的运行环境中，它能够兼容AMD、CMD、Node以及常见的浏览器环境中：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">;</span><br><span class="line">(<span class="function"><span class="keyword">function</span> (<span class="params">name, definition</span>) </span>&#123;</span><br><span class="line">   	<span class="comment">// 检测上下文环境是否为AMD或CMD</span></span><br><span class="line">   	<span class="keyword">var</span> hadDefine = <span class="keyword">typeof</span> define === <span class="string">'function'</span>,</span><br><span class="line">   	<span class="comment">// 检测上下文环境是否为Node</span></span><br><span class="line">   		hasExports = <span class="keyword">typeof</span> <span class="built_in">module</span> !== <span class="string">'undefined'</span> &amp;&amp; <span class="built_in">module</span>.exports;</span><br><span class="line">   	<span class="keyword">if</span> (hadDefine) &#123;</span><br><span class="line">   		<span class="comment">// AMD/CMD</span></span><br><span class="line">   		define(definition);</span><br><span class="line">   	&#125;</span><br><span class="line">   	<span class="keyword">else</span> <span class="keyword">if</span> (hasExports) &#123;</span><br><span class="line">   		<span class="comment">// Node</span></span><br><span class="line">   		<span class="built_in">module</span>.exports = definition();</span><br><span class="line">   	&#125;</span><br><span class="line">   	<span class="keyword">else</span> &#123;</span><br><span class="line">   		<span class="comment">// 将模块的执行结果挂在全局变量(window)中</span></span><br><span class="line">   		<span class="keyword">this</span>[name] = definition();</span><br><span class="line">   	&#125;</span><br><span class="line">   &#125;)(<span class="string">'hello'</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">   	<span class="keyword">var</span> hello = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;&#125;;</span><br><span class="line">   	<span class="keyword">return</span> hello;</span><br><span class="line">   &#125;);</span><br></pre></td></tr></table></figure></p>
<p>以上信息主要摘自书籍《深入浅出Nodejs》，有兴趣的朋友可以自己尝试前台、后台模块引入的异同，或者尝试这几种模块引入方式的异同。</p>
<hr>
<hr>
<p><img src="../../../../images/money.png" alt="money">☜☜☜ <strong><em>wechat</em></strong> 『『『<strong><em> reward 点击扫码打赏 ~~~ ^_^ </em></strong>  』』』<strong><em>alipay</em></strong> ☞☞☞   <img src="../../../../images/money.jpg" alt="money"></p>
<hr>
<hr>

            
          </span>
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    

  </section>

  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right"></i></a>
  </nav>



        </div>

        


        

      </div>

      
        
  
  <div class="sidebar-toggle" >
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel  sidebar-panel-active ">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" src="/images/default_avatar.jpg" alt="xishiyi7" itemprop="image"/>
          <p class="site-author-name" itemprop="name">xishiyi7</p>
        </div>
        <p class="site-description motion-element" itemprop="description">this is my personal post</p>
        <nav class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/archives">
              <span class="site-state-item-count">22</span>
              <span class="site-state-item-name">日志</span>
            </a>
          </div>

          <div class="site-state-item site-state-categories">
            
              <span class="site-state-item-count">0</span>
              <span class="site-state-item-name">分类</span>
              
          </div>

          <div class="site-state-item site-state-tags">
            
              <span class="site-state-item-count">2</span>
              <span class="site-state-item-name">标签</span>
              
          </div>

        </nav>

        

        <div class="links-of-author motion-element">
          
        </div>

        
        

        <div class="links-of-author motion-element">
          
        </div>

      </section>

      

    </div>
  </aside>


      
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2016</span>
  <span class="with-love">
    <i class="icon-next-heart fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">xishiyi7</span>
</div>
<!-- 隐藏部分footer
<div class="powered-by">
  由 <a class="theme-link" href="http://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT
  </a>
</div>
-->


      </div>
    </footer>

    <div class="back-to-top"></div>
  </div>

  <script type="text/javascript" src="/vendors/jquery/index.js?v=2.1.3"></script>

  
  

  
    

  
    
  

  <script type="text/javascript">
    var duoshuoQuery = {short_name:"xishiyi7"};
    (function() {
      var ds = document.createElement('script');
      ds.type = 'text/javascript';ds.async = true;
      ds.id = 'duoshuo-script';
      ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
      ds.charset = 'UTF-8';
      (document.getElementsByTagName('head')[0]
      || document.getElementsByTagName('body')[0]).appendChild(ds);
    })();
  </script>
    
     


    
  

  
  <script type="text/javascript" src="/vendors/fancybox/source/jquery.fancybox.pack.js"></script>
  <script type="text/javascript" src="/js/fancy-box.js?v=0.4.5.2"></script>


  <script type="text/javascript" src="/js/helpers.js?v=0.4.5.2"></script>
  <script type="text/javascript" src="/vendors/velocity/velocity.min.js"></script>
<script type="text/javascript" src="/vendors/velocity/velocity.ui.min.js"></script>

<script type="text/javascript" src="/js/motion.js?v=0.4.5.2" id="motion.global"></script>


  <script type="text/javascript" src="/vendors/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  <script type="text/javascript" src="/vendors/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  

  <script type="text/javascript" src="/js/bootstrap.js"></script>

  
  

  
  

</body>
</html>
